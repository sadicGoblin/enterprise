<div class="multi-calendar-container">
  <div class="calendar-side">
    <!-- Header del calendario con controles de navegación -->
    <div class="calendar-header">
      <span matTooltip="Navegación deshabilitada">
        <button mat-icon-button (click)="prevMonth()" disabled="true">
          <mat-icon>chevron_left</mat-icon>
        </button>
      </span>
      <span class="month-year-display">{{ currentMonthName }}</span>
      <span matTooltip="Si deseas gestionar tareas en otros meses, selecciona el período correspondiente">
        <button mat-icon-button (click)="nextMonth()" disabled="true">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </span>
    </div>

    <!-- Cabecera con nombres de días -->
    <div class="calendar-days-header">
      <div class="day-name" *ngFor="let day of weekDays; let i = index" (click)="selectAllDaysOfWeek(i)" [matTooltip]="'Seleccionar todos los ' + day">
        {{ day }}
      </div>
    </div>

    <!-- Cuerpo principal del calendario -->
    <div class="calendar-body">
      <div class="calendar-week" *ngFor="let week of calendar">
        <div
          *ngFor="let day of week"
          class="calendar-day"
          [class.disabled]="day.disabled || !day.isCurrentMonth"
          [class.selected]="day.selected"
          [class.today]="day.today"
          [class.outside-month]="!day.isCurrentMonth"
          [class.locked]="isDateLocked(day.date) && day.isCurrentMonth"
          [class.past-date]="isPastDate(day.date) && day.isCurrentMonth"
          (click)="onDayClick(day, $event)"
          [matTooltip]="isDateLocked(day.date) && day.isCurrentMonth ? 'Día bloqueado - actividad cumplida' : (isPastDate(day.date) && day.isCurrentMonth ? 'Fuera del período editable' : '')"
        >
          {{ day.date | date:'d' }}
          <mat-icon *ngIf="isDateLocked(day.date) && day.isCurrentMonth" class="lock-icon">lock</mat-icon>
        </div>
      </div>
    </div>

  </div>
  
  <!-- Panel lateral derecho con fechas seleccionadas -->
  <div class="selected-dates-panel">
    <div class="selected-dates-header">
      <h4>Días seleccionados:</h4><span class="date-count">{{ selectedDates.length }}</span>
      <button mat-icon-button class="clear-all-btn" (click)="clearSelection()" matTooltip="Limpiar todo">
        <mat-icon>delete_sweep</mat-icon>
      </button>
    </div>
    <div class="selected-dates-list">
      <div class="selected-date-item" *ngFor="let date of sortedDates" 
           [class.locked]="isDateLocked(date)"
           [class.past-date]="isPastDate(date) && !isDateLocked(date)">
        {{ date | date:'d/M' }}
        <button 
          mat-icon-button 
          class="remove-date-btn" 
          (click)="removeDate(date)"
          *ngIf="!isDateLocked(date) && !isPastDate(date)"
        >
          <mat-icon>close</mat-icon>
        </button>
        <mat-icon *ngIf="isDateLocked(date)" class="locked-icon" matTooltip="Actividad cumplida - no se puede eliminar">lock</mat-icon>
        <mat-icon *ngIf="isPastDate(date) && !isDateLocked(date)" class="past-icon" matTooltip="Período cerrado - no editable">history</mat-icon>
      </div>
    </div>
    <!-- Instrucciones de uso del calendario -->
    <div class="calendar-instructions">
      <small>• Click para seleccionar/quitar día</small>
      <small>• Shift+Click para seleccionar rangos</small>
    </div>
  </div>
</div>
